import{S as he,i as we,s as _e,e as r,c as H,d as w,F as Z,f as e,O as xe,g as be,m as q,h as t,ap as pe,w as V,t as J,l as K,o as ve,p as N,y as ye,x as ke,aq as Se}from"./index.55e4b2d4.js";import{l as S}from"./leaflet.a668e49c.js";import{e as fe}from"./fetchWrapper.5ae2c67b.js";import{H as ze,a as Le,b as $e,M as je}from"./Header.656dd7d4.js";import{F as Ce}from"./Footer.45f9f6a0.js";import"./stores.5480906e.js";function me(o){let l,s,g;return{c(){l=r("div"),e(l,"class","h-[calc(100%-8rem)] lg:h-[calc(100%-4rem)]")},m(f,i){be(f,l,i),s||(g=ke(o[6].call(null,l)),s=!0)},d(f){f&&ve(l),s=!1,g()}}}function Me(o){let l,s,g,f,i,u,m,_,x,C,c,y,z,M,L,O,W,b,T,Q,P,A,X,n,p,v,k,$,d,j,se,D,Y,I,ee,ie,R,te,ce,F,ne,U,oe,de,le,ue,re,B,E,ae,ge;s=new ze({props:{pageType:"map"}}),v=new Le({}),I=new $e({}),U=new je({});let h=o[4]!==null&&o[5]!==null&&me(o);return B=new Ce({props:{pageType:"main"}}),{c(){l=r("div"),H(s.$$.fragment),g=w(),f=r("div"),i=Z("svg"),u=Z("g"),m=Z("g"),_=Z("g"),x=Z("polygon"),C=w(),c=r("select"),y=r("option"),y.textContent="+0 km",z=r("option"),z.textContent="+2 km",M=r("option"),M.textContent="+5 km",L=r("option"),L.textContent="+10 km",O=r("option"),O.textContent="+15 km",W=w(),b=r("div"),T=r("div"),T.textContent="Filtry:",Q=w(),P=r("div"),A=r("div"),A.textContent="Wydarzenia",X=w(),n=r("button"),p=r("div"),H(v.$$.fragment),$=w(),d=r("div"),j=r("div"),j.textContent="Spotkania",se=w(),D=r("button"),Y=r("div"),H(I.$$.fragment),ie=w(),R=r("div"),te=r("div"),te.textContent="Og\u0142oszenia",ce=w(),F=r("button"),ne=r("div"),H(U.$$.fragment),de=w(),le=r("div"),le.innerHTML=`<div class="text-xl font-black self-center">Legenda:</div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Twoja pozycja -</div> 
            <img src="marker-user.png" class="object-contain h-8 w-8" alt=""/></div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Wydarzenie -</div> 
            <img src="m-event.png" class="object-contain h-8 w-8" alt=""/></div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Spotkanie -</div> 
            <img src="m-meeting.png" class="object-contain h-8 w-8" alt=""/></div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Og\u0142oszenie -</div> 
            <img src="m-announcement.png" class="object-contain h-8 w-8" alt=""/></div>`,ue=w(),h&&h.c(),re=w(),H(B.$$.fragment),e(x,"id","Path-Copy"),e(x,"transform","translate(20.000000, 18.384776) rotate(135.000000) translate(-20.000000, -18.384776) "),e(x,"points","33 5.38477631 33 31.3847763 29 31.3847763 28.999 9.38379168 7 9.38477631 7 5.38477631"),e(_,"id","Icon-/-ArrowRight-Copy-2"),e(_,"transform","translate(538.000000, 183.521208)"),e(m,"id","ZahnhelferDE\u2013Icon&Asset-Download"),e(m,"transform","translate(-539.000000, -199.000000)"),e(m,"fill","#ffffff"),e(m,"fill-rule","nonzero"),e(u,"id","ZahnhelferDE\u2014Design"),e(u,"stroke","none"),e(u,"stroke-width","1"),e(u,"fill","none"),e(u,"fill-rule","evenodd"),e(i,"class","text-white bg-pine absolute top-0 right-0 m-2 pointer-events-none p-2 rounded"),e(i,"xmlns","http://www.w3.org/2000/svg"),e(i,"xmlns:xlink","http://www.w3.org/1999/xlink"),e(i,"width","40px"),e(i,"height","40px"),e(i,"viewBox","0 0 38 22"),e(i,"version","1.1"),y.selected=!0,y.__value="0",y.value=y.__value,z.__value="2000",z.value=z.__value,M.__value="5000",M.value=M.__value,L.__value="10000",L.value=L.__value,O.__value="15000",O.value=O.__value,e(c,"id","radiusSelector"),e(c,"class","text-2xl font-bold rounded border-2 border-pine text-gray-600 h-14 w-48 pl-5 pr-10 bg-white hover:border-gray-400 focus:outline-none appearance-none"),o[3]===void 0&&xe(()=>o[14].call(c)),e(f,"class","absolute z-[9999] top-20 right-6"),e(T,"class","text-lg font-black self-center"),e(A,"class","text-lg font-bold"),e(p,"class","h-8 w-8 p-1 ml-auto mr-auto lg:w-12 lg:h-12 text-cocoa"),e(n,"class",k="rounded-full "+(o[0]?"bg-grass":"bg-gray")+" border-pine border-2 h-12 w-12 lg:bottom-56 lg:h-20 lg:w-20 lg:right-20 z-[9999]"),e(P,"class","flex flex-row items-center gap-2 justify-between"),e(j,"class","text-lg font-bold"),e(Y,"class","h-8 w-8 p-1 ml-auto mr-auto lg:w-12 lg:h-12 text-cocoa"),e(D,"class",ee="rounded-full "+(o[1]?"bg-grass":"bg-gray")+" border-pine border-2 h-12 w-12 lg:bottom-32 lg:h-20 lg:w-20 lg:right-20 z-[9999]"),e(d,"class","flex flex-row items-center gap-2 justify-between"),e(te,"class","text-lg font-bold"),e(ne,"class","h-8 w-8 p-1 ml-auto mr-auto lg:w-12 lg:h-12 text-cocoa"),e(F,"class",oe="rounded-full "+(o[2]?"bg-grass":"bg-gray")+" border-pine border-2 h-12 w-12 lg:bottom-8 lg:h-20 lg:w-20 lg:right-20 z-[9999]"),e(R,"class","flex flex-row items-center gap-2 justify-between"),e(b,"class","absolute z-[9999] p-4 flex flex-col bottom-4 right-4 bg-ivory text-cocoa rounded-xl border-pine border-2 gap-2"),e(le,"class","absolute z-[9999] p-4 flex flex-col bottom-4 left-4 bg-ivory text-cocoa rounded-xl border-pine border-2 gap-2"),e(l,"class","h-screen")},m(a,G){be(a,l,G),q(s,l,null),t(l,g),t(l,f),t(f,i),t(i,u),t(u,m),t(m,_),t(_,x),t(f,C),t(f,c),t(c,y),t(c,z),t(c,M),t(c,L),t(c,O),pe(c,o[3]),t(l,W),t(l,b),t(b,T),t(b,Q),t(b,P),t(P,A),t(P,X),t(P,n),t(n,p),q(v,p,null),t(b,$),t(b,d),t(d,j),t(d,se),t(d,D),t(D,Y),q(I,Y,null),t(b,ie),t(b,R),t(R,te),t(R,ce),t(R,F),t(F,ne),q(U,ne,null),t(l,de),t(l,le),t(l,ue),h&&h.m(l,null),t(l,re),q(B,l,null),E=!0,ae||(ge=[V(c,"change",o[14]),V(c,"change",o[10]),V(n,"click",o[9]),V(D,"click",o[8]),V(F,"click",o[7])],ae=!0)},p(a,[G]){G&8&&pe(c,a[3]),(!E||G&1&&k!==(k="rounded-full "+(a[0]?"bg-grass":"bg-gray")+" border-pine border-2 h-12 w-12 lg:bottom-56 lg:h-20 lg:w-20 lg:right-20 z-[9999]"))&&e(n,"class",k),(!E||G&2&&ee!==(ee="rounded-full "+(a[1]?"bg-grass":"bg-gray")+" border-pine border-2 h-12 w-12 lg:bottom-32 lg:h-20 lg:w-20 lg:right-20 z-[9999]"))&&e(D,"class",ee),(!E||G&4&&oe!==(oe="rounded-full "+(a[2]?"bg-grass":"bg-gray")+" border-pine border-2 h-12 w-12 lg:bottom-8 lg:h-20 lg:w-20 lg:right-20 z-[9999]"))&&e(F,"class",oe),a[4]!==null&&a[5]!==null?h||(h=me(a),h.c(),h.m(l,re)):h&&(h.d(1),h=null)},i(a){E||(J(s.$$.fragment,a),J(v.$$.fragment,a),J(I.$$.fragment,a),J(U.$$.fragment,a),J(B.$$.fragment,a),E=!0)},o(a){K(s.$$.fragment,a),K(v.$$.fragment,a),K(I.$$.fragment,a),K(U.$$.fragment,a),K(B.$$.fragment,a),E=!1},d(a){a&&ve(l),N(s),N(v),N(I),N(U),h&&h.d(),N(B),ae=!1,ye(ge)}}}function Oe(o){return"endDate"in o?`<div><div>${o.title}</div><a style='cursor: pointer' href='/events/${o.id}'>Przejd\u017A do strony</a></div>`:`<div><div>${o.title}</div><a style='cursor: pointer' href='/user/${o.author.id}/posts'>Przejd\u017A do post\xF3w u\u017Cytkownika</a></div>`}function Pe(o,l,s){let g=null,f=null,i=null,u=null,m=!0,_=!0,x=!0,C=!1,c="0",y=null,z=!1;navigator.geolocation.getCurrentPosition(n=>{s(4,i=n.coords.latitude),s(5,u=n.coords.longitude)}),(i===null||u===null)&&(console.log("Geolocation is not supported by this browser."),fetch("http://ip-api.com/json/").then(n=>n.json()).then(n=>{s(4,i=n.lat),s(5,u=n.lon)}));function M(n){let p=S.exports.map(n).setView([i,u],13),v=S.exports.icon({iconUrl:"marker-user.png",iconSize:[25,42]});return S.exports.marker([i,u],{icon:v}).addTo(p),S.exports.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:`&copy;<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>,
          &copy;<a href="https://carto.com/attributions" target="_blank">CARTO</a>`,subdomains:"abcd",maxZoom:17}).addTo(p),p}function L(n,p){f!==null&&f.clearLayers(),s(13,z=!1);let v=[];n.forEach(k=>{let $=null;"endDate"in k?$=S.exports.icon({iconUrl:"m-event.png",iconSize:[25,42]}):"meetingDate"in k?$=S.exports.icon({iconUrl:"m-meeting.png",iconSize:[25,42]}):$=S.exports.icon({iconUrl:"m-announcement.png",iconSize:[25,42]});let d=S.exports.marker(k.location.point.coordinates.reverse(),{interactive:!0,icon:$});d.bindPopup(Oe(k)),d.on("click",j=>{d.openPopup()}),v.push(d)}),f=S.exports.layerGroup(v).addTo(p)}function O(n){return s(11,g=M(n)),g.on("moveend",()=>{C?(console.log("on"),W()):b()}),{destroy:()=>{g.remove()}}}function W(){let n=new URLSearchParams;n.append("latitude",i),n.append("longitude",u),n.append("areEventsOn",m.toString()),n.append("areMeetingsOn",_.toString()),n.append("areAnnouncementsOn",x.toString()),n.append("maxRange",c.toString()),fe(`map/getLocationsInCircle?${n.toString()}`,"GET").then(p=>p.json()).then(p=>L(p,g))}function b(){const n=g.getBounds(),p=n._northEast.lat,v=n._southWest.lat,k=n._southWest.lng,$=n._northEast.lng;let d=new URLSearchParams;d.append("upperLat",p),d.append("lowerLat",v),d.append("leftLon",k),d.append("rightLon",$),d.append("areEventsOn",m.toString()),d.append("areMeetingsOn",_.toString()),d.append("areAnnouncementsOn",x.toString()),fe(`map/getLocationsInBox?${d.toString()}`,"GET").then(j=>j.json()).then(j=>L(j,g))}function T(){s(2,x=!x)}function Q(){s(1,_=!_)}function P(){s(0,m=!m)}function A(){s(12,C=c!="0"),y!==null&&y.remove(),y=S.exports.circle([i,u],{radius:c}).addTo(g)}function X(){c=Se(this),s(3,c)}return o.$$.update=()=>{o.$$.dirty&14351&&(g!==null&&!C?b():g!==null&&C&&W())},[m,_,x,c,i,u,O,T,Q,P,A,g,C,z,X]}class Fe extends he{constructor(l){super(),we(this,l,Pe,Me,_e,{})}}export{Fe as default};
