import{S as V,i as J,s as K,l as y,m as $,n as M,F as P,o as t,N as Q,a as q,p as A,q as s,ao as D,w as I,b as R,t as U,d as N,v as B,z as X,x as Y,ap as ee}from"./index.b73d61b7.js";import{l as x}from"./leaflet.a668e49c.js";import{e as F}from"./fetchWrapper.486a233b.js";import{H as te}from"./Header.f3d8069a.js";import{F as ne}from"./Footer.6c455db6.js";import"./stores.f7ba8009.js";function G(r){let n,a,p;return{c(){n=y("div"),t(n,"class","h-[calc(100%-8rem)] lg:h-[calc(100%-4rem)]")},m(u,o){q(u,n,o),a||(p=Y(r[3].call(null,n)),a=!0)},d(u){u&&N(n),a=!1,p()}}}function oe(r){let n,a,p,u,o,l,f,h,k,C,c,w,j,S,L,z,T,e,d,b,g,_,i,O;a=new te({props:{pageType:"map"}});let v=r[1]!==null&&r[2]!==null&&G(r);return g=new ne({props:{pageType:"main"}}),{c(){n=y("div"),$(a.$$.fragment),p=M(),u=y("div"),o=P("svg"),l=P("g"),f=P("g"),h=P("g"),k=P("polygon"),C=M(),c=y("select"),w=y("option"),w.textContent="+0 km",j=y("option"),j.textContent="+2 km",S=y("option"),S.textContent="+5 km",L=y("option"),L.textContent="+10 km",z=y("option"),z.textContent="+15 km",T=M(),e=y("div"),e.innerHTML=`<div class="text-xl font-black self-center">Legenda:</div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Twoja pozycja -</div> 
            <img src="marker-user.png" class="object-contain h-8 w-8" alt=""/></div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Wydarzenie -</div> 
            <img src="m-event.png" class="object-contain h-8 w-8" alt=""/></div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Spotkanie -</div> 
            <img src="m-meeting.png" class="object-contain h-8 w-8" alt=""/></div> 
        <div class="flex flex-row items-center justify-between"><div class="font-semibold">Og\u0142oszenie -</div> 
            <img src="m-announcement.png" class="object-contain h-8 w-8" alt=""/></div>`,d=M(),v&&v.c(),b=M(),$(g.$$.fragment),t(k,"id","Path-Copy"),t(k,"transform","translate(20.000000, 18.384776) rotate(135.000000) translate(-20.000000, -18.384776) "),t(k,"points","33 5.38477631 33 31.3847763 29 31.3847763 28.999 9.38379168 7 9.38477631 7 5.38477631"),t(h,"id","Icon-/-ArrowRight-Copy-2"),t(h,"transform","translate(538.000000, 183.521208)"),t(f,"id","ZahnhelferDE\u2013Icon&Asset-Download"),t(f,"transform","translate(-539.000000, -199.000000)"),t(f,"fill","#ffffff"),t(f,"fill-rule","nonzero"),t(l,"id","ZahnhelferDE\u2014Design"),t(l,"stroke","none"),t(l,"stroke-width","1"),t(l,"fill","none"),t(l,"fill-rule","evenodd"),t(o,"class","text-white bg-pine absolute top-0 right-0 m-2 pointer-events-none p-2 rounded"),t(o,"xmlns","http://www.w3.org/2000/svg"),t(o,"xmlns:xlink","http://www.w3.org/1999/xlink"),t(o,"width","40px"),t(o,"height","40px"),t(o,"viewBox","0 0 38 22"),t(o,"version","1.1"),w.selected=!0,w.__value="0",w.value=w.__value,j.__value="2000",j.value=j.__value,S.__value="5000",S.value=S.__value,L.__value="10000",L.value=L.__value,z.__value="15000",z.value=z.__value,t(c,"id","radiusSelector"),t(c,"class","text-2xl font-bold rounded border-2 border-pine text-gray-600 h-14 w-48 pl-5 pr-10 bg-white hover:border-gray-400 focus:outline-none appearance-none"),r[0]===void 0&&Q(()=>r[8].call(c)),t(u,"class","absolute z-[9999] top-20 right-6"),t(e,"class","absolute z-[9999] p-4 flex flex-col bottom-4 right-4 bg-ivory text-cocoa rounded-xl border-pine border-2 gap-2"),t(n,"class","h-screen")},m(m,E){q(m,n,E),A(a,n,null),s(n,p),s(n,u),s(u,o),s(o,l),s(l,f),s(f,h),s(h,k),s(u,C),s(u,c),s(c,w),s(c,j),s(c,S),s(c,L),s(c,z),D(c,r[0]),s(n,T),s(n,e),s(n,d),v&&v.m(n,null),s(n,b),A(g,n,null),_=!0,i||(O=[I(c,"change",r[8]),I(c,"change",r[4])],i=!0)},p(m,[E]){E&1&&D(c,m[0]),m[1]!==null&&m[2]!==null?v||(v=G(m),v.c(),v.m(n,b)):v&&(v.d(1),v=null)},i(m){_||(R(a.$$.fragment,m),R(g.$$.fragment,m),_=!0)},o(m){U(a.$$.fragment,m),U(g.$$.fragment,m),_=!1},d(m){m&&N(n),B(a),v&&v.d(),B(g),i=!1,X(O)}}}let H=!0,W=!0,Z=!0;function re(r){return"endDate"in r?`<div><div>${r.title}</div><a style='cursor: pointer' href='/events/${r.id}'>Przejd\u017A do strony</a></div>`:`<div><div>${r.title}</div><a style='cursor: pointer' href='/user/${r.author.id}/posts'>Przejd\u017A do post\xF3w u\u017Cytkownika</a></div>`}function ae(r,n,a){let p=null,u=null,o=null,l=null,f=!1,h="0",k=null,C=!1;navigator.geolocation.getCurrentPosition(e=>{a(1,o=e.coords.latitude),a(2,l=e.coords.longitude)}),(o===null||l===null)&&(console.log("Geolocation is not supported by this browser."),fetch("http://ip-api.com/json/").then(e=>e.json()).then(e=>{a(1,o=e.lat),a(2,l=e.lon)}));function c(e){let d=x.exports.map(e).setView([o,l],13),b=x.exports.icon({iconUrl:"marker-user.png",iconSize:[25,42]});return x.exports.marker([o,l],{icon:b}).addTo(d),x.exports.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:`&copy;<a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>,
          &copy;<a href="https://carto.com/attributions" target="_blank">CARTO</a>`,subdomains:"abcd",maxZoom:17}).addTo(d),d}function w(e,d){u!==null&&u.clearLayers(),a(7,C=!1);let b=[];e.forEach(g=>{let _=null;"endDate"in g?_=x.exports.icon({iconUrl:"m-event.png",iconSize:[25,42]}):"meetingDate"in g?_=x.exports.icon({iconUrl:"m-meeting.png",iconSize:[25,42]}):_=x.exports.icon({iconUrl:"m-announcement.png",iconSize:[25,42]});let i=x.exports.marker(g.location.point.coordinates.reverse(),{interactive:!0,icon:_});i.bindPopup(re(g)),i.on("click",O=>{i.openPopup()}),b.push(i)}),u=x.exports.layerGroup(b).addTo(d)}function j(e){return a(5,p=c(e)),p.on("moveend",()=>{f?(console.log("on"),S()):L()}),{destroy:()=>{p.remove()}}}function S(){let e=new URLSearchParams;e.append("latitude",o),e.append("longitude",l),e.append("areEventsOn",H.toString()),e.append("areMeetingsOn",W.toString()),e.append("areAnnouncementsOn",Z.toString()),e.append("maxRange",h.toString()),F(`map/getLocationsInCircle?${e.toString()}`,"GET").then(d=>d.json()).then(d=>w(d,p))}function L(){const e=p.getBounds(),d=e._northEast.lat,b=e._southWest.lat,g=e._southWest.lng,_=e._northEast.lng;let i=new URLSearchParams;i.append("upperLat",d),i.append("lowerLat",b),i.append("leftLon",g),i.append("rightLon",_),i.append("areEventsOn",H.toString()),i.append("areMeetingsOn",W.toString()),i.append("areAnnouncementsOn",Z.toString()),F(`map/getLocationsInBox?${i.toString()}`,"GET").then(O=>O.json()).then(O=>w(O,p))}function z(){a(6,f=h!="0"),k!==null&&k.remove(),k=x.exports.circle([o,l],{radius:h}).addTo(p)}function T(){h=ee(this),a(0,h)}return r.$$.update=()=>{r.$$.dirty&225&&(p!==null&&!f?L():p!==null&&f&&S())},[h,o,l,j,z,p,f,C,T]}class de extends V{constructor(n){super(),J(this,n,ae,oe,K,{})}}export{de as default};
